p=p + annotate(geom="segment",x=synlay-0.8,xend=synlay-nsize,y=1+2*nsize,yend=1+2*nsize,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = 0.1, y = 2.4, label = "0ms",size=3,hjust=0)
p = p + annotate("text",x = lexlay+0.3, y = 2.4, label = "400ms",size=3,hjust=0)
p = p + annotate("text",x = synlay+0.3, y = 2.4, label = "600ms",size=3,hjust=0)
p = p + annotate("text",x = lexlay+0.19, y = 0.9, label = "NextWord\nError")
p = p + annotate("text",x = synlay+0.19, y = 0.9, label = "Hidden\nError")
p = p + annotate("text",x = 1.4, y = -0.6, label = "PrevWord\nActivation")
p = p + annotate("text",x = 3.2, y = -0.6, label = "Hidden\nActivation")
p = p + annotate("text",x = 1.2, y = -1.3, label = "Forward Spread\nof Activation",size=3,hjust=0.5)
p = p + annotate("text",x = 2.6, y = -2.1, label = "CConcept\nActivation")
p=p + annotate(geom="segment",x=2.0,xend=2.5,y=-0.4,yend=-0.8,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = 4.5, y = -2.1, label = "MeaningComp\nActivation")
p=p + annotate(geom="segment",x=3.2,xend=3.9,y=-1.4,yend=-1.4,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=3.7,xend=4.4,y=-0.4,yend=-0.9,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
# legend
p = p + annotate("text",x = 1.5, y = erppos-0.6, label = "Violation",size=3,hjust=0)
p = p + annotate("text",x = 1.5, y = erppos-0.8, label = "Control",size=3,hjust=0)
p = p + annotate("segment",x = 1, xend=1.4, y = erppos-0.6, yend=erppos-0.6)
p = p + annotate("segment",x = 1, xend=1.4, y = erppos-0.8,yend = erppos-0.8, linetype="dashed")
# arrows to erps
p=p + annotate(geom="segment",x=lexlay+nsize/2,xend=lexlay+nsize/2,y=2.1,yend=erppos-0.4,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=synlay+nsize/2,xend=synlay+nsize/2,y=2.1,yend=erppos-0.4,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = lexlay-0.1, y = 2.3, label = "sum()",size=5,hjust=0.5, parse=T)
p = p + annotate("text",x = synlay-0.1, y = 2.3, label = "sum()",size=5,hjust=0.5, parse=T)
p = p + annotate("text",x = (lexlay+synlay)/2, y = 2.2, label = "Sum Abs. Error",size=3,hjust=0.5)
p = p + annotate("text",x = 0.3, y = 0.1, label = "\"was\"",size=4,hjust=0.5)
p=p + annotate(geom="segment",x=0.6,xend=0.9,y=0.1,yend=0.1,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = 2.1, y = 1.3, label = "Target\nSignal",size=3,hjust=0.5)
p=p + annotate(geom="segment",x=1.9,xend=3,y=0.8,yend=1.5,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=2,xend=2.7,y=0.1,yend=0.1,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = -0.1, y = 3.5, label = "+",size=5,hjust=0.5)
p = p + annotate("text",x = -0.1, y = 2.5, label = "-",size=5,hjust=0.5)
p = p + annotate("text",x = 5, y = -0.4, label = "Main Clause/Sentence Complement Ambiguity:\nThe judge charged (that) the defendant was lying",hjust=0,size=3)
#p = p + annotate("text",x = 7, y = -0.5, label = "",hjust=0.5,size=3)
p = p + annotate("text", x = 7.64, y = -0.49, label = "was",
size=3, fontface =2)
p = p + annotate("text",x = 6.4, y = 3.5, label = "ERPs",hjust=0.5,size=3)
p = p + annotate("text",x = 4.3, y = 0.1, label = "Eye-movements",hjust=0.5,size=3)
p = p + annotate("text",x = 6, y = -1.5, label = "Judgements/\nQuestion Answering",hjust=0.5,size=3)
p = p + annotate(geom="curve",x=5,xend=5,y=-1.6,yend=-1.2,curvature=1.5,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + scale_fill_gradient(low = "white", high = "black")
p = p + scale_colour_gradient(low = "white", high = "black")
p = p + theme(axis.line=element_blank(),axis.text.x=element_blank(),
axis.text.y=element_blank(),axis.ticks=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),legend.position="none",
panel.background=element_blank(),panel.border=element_blank(),panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),plot.background=element_blank())
p
ggsave("img/brain3.png",width=8,height=6)
p =ggplot(brain)
p = p +geom_tile(aes(x=x,y=y+1,fill=error),colour="black")
p = p +geom_text(aes(x=x,y=y+1,label="-"),subset(brain,layer=="lexical"),size=4,colour="black")
p = p +geom_tile(aes(x=xx-2.2,y=y-0.5,fill=act),colour="black")
p = p +geom_tile(aes(x=xx-1,y=y-2,fill=meaning),colour="black")
p = p + annotate(geom="segment",x=0,xend=0,y=0,yend=3.5,linetype="dotted",colour="gray50") # 0 axis
# scalp erps
erppos=3
p = p +geom_line(mapping=aes(x=x,y=sourceerp+erppos),data=eegwaves,colour="black")
p = p +geom_line(mapping=aes(x=x,y=sourceerp2+erppos),data=eegwaves,colour="black",linetype="dashed")
p = p + annotate("text",x = (lexlay+synlay)*0.55, y = 1, label = "Back-propagation\nof Error",size=3,hjust=0.5)
p = p + annotate("text",x = synlay-0.9, y = 1+2*nsize, label = "sum()",size=3,hjust=0.5, parse=T)
p=p + annotate(geom="segment",x=lexlay+nsize*2,xend=synlay-1,y=1+nsize,yend=1+2*nsize,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=lexlay+nsize*2,xend=synlay-1,y=1+2*nsize,yend=1+2*nsize,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=lexlay+nsize*2,xend=synlay-1,y=1+3*nsize,yend=1+2*nsize,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
#p=p + annotate(geom="segment",x=(lexlay+synlay)*0.25,xend=(lexlay+synlay)*0.75,y=1,yend=1,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=synlay-0.8,xend=synlay-nsize,y=1+2*nsize,yend=1+2*nsize,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = 0.1, y = 2.4, label = "0ms",size=3,hjust=0)
p = p + annotate("text",x = lexlay+0.3, y = 2.4, label = "400ms",size=3,hjust=0)
p = p + annotate("text",x = synlay+0.3, y = 2.4, label = "600ms",size=3,hjust=0)
p = p + annotate("text",x = lexlay+0.19, y = 0.9, label = "NextWord\nError")
p = p + annotate("text",x = synlay+0.19, y = 0.9, label = "Hidden\nError")
p = p + annotate("text",x = 1.4, y = -0.6, label = "PrevWord\nActivation")
p = p + annotate("text",x = 3.2, y = -0.6, label = "Hidden\nActivation")
p = p + annotate("text",x = 1.2, y = -1.3, label = "Forward Spread\nof Activation",size=3,hjust=0.5)
p = p + annotate("text",x = 2.6, y = -2.1, label = "CConcept\nActivation")
p=p + annotate(geom="segment",x=2.0,xend=2.5,y=-0.4,yend=-0.8,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = 4.5, y = -2.1, label = "MeaningComp\nActivation")
p=p + annotate(geom="segment",x=3.2,xend=3.9,y=-1.4,yend=-1.4,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=3.7,xend=4.4,y=-0.4,yend=-0.9,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
# legend
p = p + annotate("text",x = 1.5, y = erppos-0.6, label = "Violation",size=3,hjust=0)
p = p + annotate("text",x = 1.5, y = erppos-0.8, label = "Control",size=3,hjust=0)
p = p + annotate("segment",x = 1, xend=1.4, y = erppos-0.6, yend=erppos-0.6)
p = p + annotate("segment",x = 1, xend=1.4, y = erppos-0.8,yend = erppos-0.8, linetype="dashed")
# arrows to erps
p=p + annotate(geom="segment",x=lexlay+nsize/2,xend=lexlay+nsize/2,y=2.1,yend=erppos-0.4,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=synlay+nsize/2,xend=synlay+nsize/2,y=2.1,yend=erppos-0.4,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = lexlay-0.1, y = 2.3, label = "sum()",size=5,hjust=0.5, parse=T)
p = p + annotate("text",x = synlay-0.1, y = 2.3, label = "sum()",size=5,hjust=0.5, parse=T)
p = p + annotate("text",x = (lexlay+synlay)/2, y = 2.2, label = "Sum Abs. Error",size=3,hjust=0.5)
p = p + annotate("text",x = 0.3, y = 0.1, label = "\"was\"",size=4,hjust=0.5)
p=p + annotate(geom="segment",x=0.6,xend=0.9,y=0.1,yend=0.1,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = 2.1, y = 1.3, label = "Target\nSignal",size=3,hjust=0.5)
p=p + annotate(geom="segment",x=1.9,xend=3,y=0.8,yend=1.5,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=2,xend=2.7,y=0.1,yend=0.1,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = -0.1, y = 3.5, label = "+",size=5,hjust=0.5)
p = p + annotate("text",x = -0.1, y = 2.5, label = "-",size=5,hjust=0.5)
p = p + annotate("text",x = 5, y = -0.4, label = "Main Clause/Sentence Complement Ambiguity:\nThe judge charged (that) the defendant was lying",hjust=0,size=3)
#p = p + annotate("text",x = 7, y = -0.5, label = "",hjust=0.5,size=3)
p = p + annotate("text", x = 7.63, y = -0.49, label = "was",
size=3, fontface =2)
p = p + annotate("text",x = 6.4, y = 3.5, label = "ERPs",hjust=0.5,size=3)
p = p + annotate("text",x = 4.3, y = 0.1, label = "Eye-movements",hjust=0.5,size=3)
p = p + annotate("text",x = 6, y = -1.5, label = "Judgements/\nQuestion Answering",hjust=0.5,size=3)
p = p + annotate(geom="curve",x=5,xend=5,y=-1.6,yend=-1.2,curvature=1.5,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + scale_fill_gradient(low = "white", high = "black")
p = p + scale_colour_gradient(low = "white", high = "black")
p = p + theme(axis.line=element_blank(),axis.text.x=element_blank(),
axis.text.y=element_blank(),axis.ticks=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),legend.position="none",
panel.background=element_blank(),panel.border=element_blank(),panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),plot.background=element_blank())
p
ggsave("img/brain3.png",width=8,height=6)
p =ggplot(brain)
p = p +geom_tile(aes(x=x,y=y+1,fill=error),colour="black")
p = p +geom_text(aes(x=x,y=y+1,label="-"),subset(brain,layer=="lexical"),size=4,colour="black")
p = p +geom_tile(aes(x=xx-2.2,y=y-0.5,fill=act),colour="black")
p = p +geom_tile(aes(x=xx-1,y=y-2,fill=meaning),colour="black")
p = p + annotate(geom="segment",x=0,xend=0,y=0,yend=3.5,linetype="dotted",colour="gray50") # 0 axis
# scalp erps
erppos=3
p = p +geom_line(mapping=aes(x=x,y=sourceerp+erppos),data=eegwaves,colour="black")
p = p +geom_line(mapping=aes(x=x,y=sourceerp2+erppos),data=eegwaves,colour="black",linetype="dashed")
p = p + annotate("text",x = (lexlay+synlay)*0.55, y = 1, label = "Back-propagation\nof Error",size=3,hjust=0.5)
p = p + annotate("text",x = synlay-0.9, y = 1+2*nsize, label = "sum()",size=3,hjust=0.5, parse=T)
p=p + annotate(geom="segment",x=lexlay+nsize*2,xend=synlay-1,y=1+nsize,yend=1+2*nsize,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=lexlay+nsize*2,xend=synlay-1,y=1+2*nsize,yend=1+2*nsize,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=lexlay+nsize*2,xend=synlay-1,y=1+3*nsize,yend=1+2*nsize,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
#p=p + annotate(geom="segment",x=(lexlay+synlay)*0.25,xend=(lexlay+synlay)*0.75,y=1,yend=1,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=synlay-0.8,xend=synlay-nsize,y=1+2*nsize,yend=1+2*nsize,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = 0.1, y = 2.4, label = "0ms",size=3,hjust=0)
p = p + annotate("text",x = lexlay+0.3, y = 2.4, label = "400ms",size=3,hjust=0)
p = p + annotate("text",x = synlay+0.3, y = 2.4, label = "600ms",size=3,hjust=0)
p = p + annotate("text",x = lexlay+0.19, y = 0.9, label = "NextWord\nError")
p = p + annotate("text",x = synlay+0.19, y = 0.9, label = "Hidden\nError")
p = p + annotate("text",x = 1.4, y = -0.6, label = "PrevWord\nActivation")
p = p + annotate("text",x = 3.2, y = -0.6, label = "Hidden\nActivation")
p = p + annotate("text",x = 1.2, y = -1.3, label = "Forward Spread\nof Activation",size=3,hjust=0.5)
p = p + annotate("text",x = 2.6, y = -2.1, label = "CConcept\nActivation")
p=p + annotate(geom="segment",x=2.0,xend=2.5,y=-0.4,yend=-0.8,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = 4.5, y = -2.1, label = "MeaningComp\nActivation")
p=p + annotate(geom="segment",x=3.2,xend=3.9,y=-1.4,yend=-1.4,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=3.7,xend=4.4,y=-0.4,yend=-0.9,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
# legend
p = p + annotate("text",x = 1.5, y = erppos-0.6, label = "Violation",size=3,hjust=0)
p = p + annotate("text",x = 1.5, y = erppos-0.8, label = "Control",size=3,hjust=0)
p = p + annotate("segment",x = 1, xend=1.4, y = erppos-0.6, yend=erppos-0.6)
p = p + annotate("segment",x = 1, xend=1.4, y = erppos-0.8,yend = erppos-0.8, linetype="dashed")
# arrows to erps
p=p + annotate(geom="segment",x=lexlay+nsize/2,xend=lexlay+nsize/2,y=2.1,yend=erppos-0.4,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=synlay+nsize/2,xend=synlay+nsize/2,y=2.1,yend=erppos-0.4,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = lexlay-0.1, y = 2.3, label = "sum()",size=5,hjust=0.5, parse=T)
p = p + annotate("text",x = synlay-0.1, y = 2.3, label = "sum()",size=5,hjust=0.5, parse=T)
p = p + annotate("text",x = (lexlay+synlay)/2, y = 2.2, label = "Sum Abs. Error",size=3,hjust=0.5)
p = p + annotate("text",x = 0.3, y = 0.1, label = "\"was\"",size=4,hjust=0.5)
p=p + annotate(geom="segment",x=0.6,xend=0.9,y=0.1,yend=0.1,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = 2.1, y = 1.3, label = "Target\nSignal",size=3,hjust=0.5)
p=p + annotate(geom="segment",x=1.9,xend=3,y=0.8,yend=1.5,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=2,xend=2.7,y=0.1,yend=0.1,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = -0.1, y = 3.5, label = "+",size=5,hjust=0.5)
p = p + annotate("text",x = -0.1, y = 2.5, label = "-",size=5,hjust=0.5)
p = p + annotate("text",x = 5, y = -0.4, label = "Main Clause/Sentence Complement Ambiguity:\n\"The judge charged (that) the defendant was lying\"",hjust=0,size=3)
#p = p + annotate("text",x = 7, y = -0.5, label = "",hjust=0.5,size=3)
p = p + annotate("text", x = 7.64, y = -0.49, label = "was",
size=3, fontface =2)
p = p + annotate("text",x = 6.4, y = 3.5, label = "ERPs",hjust=0.5,size=3)
p = p + annotate("text",x = 4.3, y = 0.1, label = "Eye-movements",hjust=0.5,size=3)
p = p + annotate("text",x = 6, y = -1.5, label = "Judgements/\nQuestion Answering",hjust=0.5,size=3)
p = p + annotate(geom="curve",x=5,xend=5,y=-1.6,yend=-1.2,curvature=1.5,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + scale_fill_gradient(low = "white", high = "black")
p = p + scale_colour_gradient(low = "white", high = "black")
p = p + theme(axis.line=element_blank(),axis.text.x=element_blank(),
axis.text.y=element_blank(),axis.ticks=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),legend.position="none",
panel.background=element_blank(),panel.border=element_blank(),panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),plot.background=element_blank())
p
ggsave("img/brain3.png",width=8,height=6)
p =ggplot(brain)
p = p +geom_tile(aes(x=x,y=y+1,fill=error),colour="black")
p = p +geom_text(aes(x=x,y=y+1,label="-"),subset(brain,layer=="lexical"),size=4,colour="black")
p = p +geom_tile(aes(x=xx-2.2,y=y-0.5,fill=act),colour="black")
p = p +geom_tile(aes(x=xx-1,y=y-2,fill=meaning),colour="black")
p = p + annotate(geom="segment",x=0,xend=0,y=0,yend=3.5,linetype="dotted",colour="gray50") # 0 axis
# scalp erps
erppos=3
p = p +geom_line(mapping=aes(x=x,y=sourceerp+erppos),data=eegwaves,colour="black")
p = p +geom_line(mapping=aes(x=x,y=sourceerp2+erppos),data=eegwaves,colour="black",linetype="dashed")
p = p + annotate("text",x = (lexlay+synlay)*0.55, y = 1, label = "Back-propagation\nof Error",size=3,hjust=0.5)
p = p + annotate("text",x = synlay-0.9, y = 1+2*nsize, label = "sum()",size=3,hjust=0.5, parse=T)
p=p + annotate(geom="segment",x=lexlay+nsize*2,xend=synlay-1,y=1+nsize,yend=1+2*nsize,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=lexlay+nsize*2,xend=synlay-1,y=1+2*nsize,yend=1+2*nsize,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=lexlay+nsize*2,xend=synlay-1,y=1+3*nsize,yend=1+2*nsize,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
#p=p + annotate(geom="segment",x=(lexlay+synlay)*0.25,xend=(lexlay+synlay)*0.75,y=1,yend=1,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=synlay-0.8,xend=synlay-nsize,y=1+2*nsize,yend=1+2*nsize,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = 0.1, y = 2.4, label = "0ms",size=3,hjust=0)
p = p + annotate("text",x = lexlay+0.3, y = 2.4, label = "400ms",size=3,hjust=0)
p = p + annotate("text",x = synlay+0.3, y = 2.4, label = "600ms",size=3,hjust=0)
p = p + annotate("text",x = lexlay+0.19, y = 0.9, label = "NextWord\nError")
p = p + annotate("text",x = synlay+0.19, y = 0.9, label = "Hidden\nError")
p = p + annotate("text",x = 1.4, y = -0.6, label = "PrevWord\nActivation")
p = p + annotate("text",x = 3.2, y = -0.6, label = "Hidden\nActivation")
p = p + annotate("text",x = 1.2, y = -1.3, label = "Forward Spread\nof Activation",size=3,hjust=0.5)
p = p + annotate("text",x = 2.6, y = -2.1, label = "CConcept\nActivation")
p=p + annotate(geom="segment",x=2.0,xend=2.5,y=-0.4,yend=-0.8,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = 4.5, y = -2.1, label = "MeaningComp\nActivation")
p=p + annotate(geom="segment",x=3.2,xend=3.9,y=-1.4,yend=-1.4,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=3.7,xend=4.4,y=-0.4,yend=-0.9,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
# legend
p = p + annotate("text",x = 1.5, y = erppos-0.6, label = "Violation",size=3,hjust=0)
p = p + annotate("text",x = 1.5, y = erppos-0.8, label = "Control",size=3,hjust=0)
p = p + annotate("segment",x = 1, xend=1.4, y = erppos-0.6, yend=erppos-0.6)
p = p + annotate("segment",x = 1, xend=1.4, y = erppos-0.8,yend = erppos-0.8, linetype="dashed")
# arrows to erps
p=p + annotate(geom="segment",x=lexlay+nsize/2,xend=lexlay+nsize/2,y=2.1,yend=erppos-0.4,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=synlay+nsize/2,xend=synlay+nsize/2,y=2.1,yend=erppos-0.4,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = lexlay-0.1, y = 2.3, label = "sum()",size=5,hjust=0.5, parse=T)
p = p + annotate("text",x = synlay-0.1, y = 2.3, label = "sum()",size=5,hjust=0.5, parse=T)
p = p + annotate("text",x = (lexlay+synlay)/2, y = 2.2, label = "Sum Abs. Error",size=3,hjust=0.5)
p = p + annotate("text",x = 0.3, y = 0.1, label = "\"was\"",size=4,hjust=0.5)
p=p + annotate(geom="segment",x=0.6,xend=0.9,y=0.1,yend=0.1,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = 2.1, y = 1.3, label = "Target\nSignal",size=3,hjust=0.5)
p=p + annotate(geom="segment",x=1.9,xend=3,y=0.8,yend=1.5,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=2,xend=2.7,y=0.1,yend=0.1,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = -0.1, y = 3.5, label = "+",size=5,hjust=0.5)
p = p + annotate("text",x = -0.1, y = 2.5, label = "-",size=5,hjust=0.5)
p = p + annotate("text",x = 5, y = -0.4, label = "Main Clause/Sentence Complement Ambiguity:\n\"The judge charged (that) the defendant was lying\"",hjust=0,size=3)
#p = p + annotate("text",x = 7, y = -0.5, label = "",hjust=0.5,size=3)
p = p + annotate("text", x = 7.65, y = -0.49, label = "was",
size=3, fontface =2)
p = p + annotate("text",x = 6.4, y = 3.5, label = "ERPs",hjust=0.5,size=3)
p = p + annotate("text",x = 4.3, y = 0.1, label = "Eye-movements",hjust=0.5,size=3)
p = p + annotate("text",x = 6, y = -1.5, label = "Judgements/\nQuestion Answering",hjust=0.5,size=3)
p = p + annotate(geom="curve",x=5,xend=5,y=-1.6,yend=-1.2,curvature=1.5,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + scale_fill_gradient(low = "white", high = "black")
p = p + scale_colour_gradient(low = "white", high = "black")
p = p + theme(axis.line=element_blank(),axis.text.x=element_blank(),
axis.text.y=element_blank(),axis.ticks=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),legend.position="none",
panel.background=element_blank(),panel.border=element_blank(),panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),plot.background=element_blank())
p
ggsave("img/brain3.png",width=8,height=6)
p =ggplot(brain)
p = p +geom_tile(aes(x=x,y=y+1,fill=error),colour="black")
p = p +geom_text(aes(x=x,y=y+1,label="-"),subset(brain,layer=="lexical"),size=4,colour="black")
p = p +geom_tile(aes(x=xx-2.2,y=y-0.5,fill=act),colour="black")
p = p +geom_tile(aes(x=xx-1,y=y-2,fill=meaning),colour="black")
p = p + annotate(geom="segment",x=0,xend=0,y=0,yend=3.5,linetype="dotted",colour="gray50") # 0 axis
# scalp erps
erppos=3
p = p +geom_line(mapping=aes(x=x,y=sourceerp+erppos),data=eegwaves,colour="black")
p = p +geom_line(mapping=aes(x=x,y=sourceerp2+erppos),data=eegwaves,colour="black",linetype="dashed")
p = p + annotate("text",x = (lexlay+synlay)*0.55, y = 1, label = "Back-propagation\nof Error",size=3,hjust=0.5)
p = p + annotate("text",x = synlay-0.9, y = 1+2*nsize, label = "sum()",size=3,hjust=0.5, parse=T)
p=p + annotate(geom="segment",x=lexlay+nsize*2,xend=synlay-1,y=1+nsize,yend=1+2*nsize,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=lexlay+nsize*2,xend=synlay-1,y=1+2*nsize,yend=1+2*nsize,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=lexlay+nsize*2,xend=synlay-1,y=1+3*nsize,yend=1+2*nsize,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
#p=p + annotate(geom="segment",x=(lexlay+synlay)*0.25,xend=(lexlay+synlay)*0.75,y=1,yend=1,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=synlay-0.8,xend=synlay-nsize,y=1+2*nsize,yend=1+2*nsize,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = 0.1, y = 2.4, label = "0ms",size=3,hjust=0)
p = p + annotate("text",x = lexlay+0.3, y = 2.4, label = "400ms",size=3,hjust=0)
p = p + annotate("text",x = synlay+0.3, y = 2.4, label = "600ms",size=3,hjust=0)
p = p + annotate("text",x = lexlay+0.19, y = 0.9, label = "NextWord\nError")
p = p + annotate("text",x = synlay+0.19, y = 0.9, label = "Hidden\nError")
p = p + annotate("text",x = 1.4, y = -0.6, label = "PrevWord\nActivation")
p = p + annotate("text",x = 3.2, y = -0.6, label = "Hidden\nActivation")
p = p + annotate("text",x = 1.2, y = -1.3, label = "Forward Spread\nof Activation",size=3,hjust=0.5)
p = p + annotate("text",x = 2.6, y = -2.1, label = "CConcept\nActivation")
p=p + annotate(geom="segment",x=2.0,xend=2.5,y=-0.4,yend=-0.8,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = 4.5, y = -2.1, label = "MeaningComp\nActivation")
p=p + annotate(geom="segment",x=3.2,xend=3.9,y=-1.4,yend=-1.4,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=3.7,xend=4.4,y=-0.4,yend=-0.9,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
# legend
p = p + annotate("text",x = 1.5, y = erppos-0.6, label = "Violation",size=3,hjust=0)
p = p + annotate("text",x = 1.5, y = erppos-0.8, label = "Control",size=3,hjust=0)
p = p + annotate("segment",x = 1, xend=1.4, y = erppos-0.6, yend=erppos-0.6)
p = p + annotate("segment",x = 1, xend=1.4, y = erppos-0.8,yend = erppos-0.8, linetype="dashed")
# arrows to erps
p=p + annotate(geom="segment",x=lexlay+nsize/2,xend=lexlay+nsize/2,y=2.1,yend=erppos-0.4,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=synlay+nsize/2,xend=synlay+nsize/2,y=2.1,yend=erppos-0.4,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = lexlay-0.1, y = 2.3, label = "sum()",size=5,hjust=0.5, parse=T)
p = p + annotate("text",x = synlay-0.1, y = 2.3, label = "sum()",size=5,hjust=0.5, parse=T)
p = p + annotate("text",x = (lexlay+synlay)/2, y = 2.2, label = "Sum Abs. Error",size=3,hjust=0.5)
p = p + annotate("text",x = 0.3, y = 0.1, label = "\"was\"",size=4,hjust=0.5)
p=p + annotate(geom="segment",x=0.6,xend=0.9,y=0.1,yend=0.1,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = 2.1, y = 1.3, label = "Target\nSignal",size=3,hjust=0.5)
p=p + annotate(geom="segment",x=1.9,xend=3,y=0.8,yend=1.5,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=2,xend=2.7,y=0.1,yend=0.1,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = -0.1, y = 3.5, label = "+",size=5,hjust=0.5)
p = p + annotate("text",x = -0.1, y = 2.5, label = "-",size=5,hjust=0.5)
p = p + annotate("text",x = 5, y = -0.4, label = "Main Clause/Sentence Complement Ambiguity:\n\"The judge charged (that) the defendant was lying\"",hjust=0,size=3)
#p = p + annotate("text",x = 7, y = -0.5, label = "",hjust=0.5,size=3)
p = p + annotate("text", x = 7.66, y = -0.49, label = "was",
size=3, fontface =2)
p = p + annotate("text",x = 6.4, y = 3.5, label = "ERPs",hjust=0.5,size=3)
p = p + annotate("text",x = 4.3, y = 0.1, label = "Eye-movements",hjust=0.5,size=3)
p = p + annotate("text",x = 6, y = -1.5, label = "Judgements/\nQuestion Answering",hjust=0.5,size=3)
p = p + annotate(geom="curve",x=5,xend=5,y=-1.6,yend=-1.2,curvature=1.5,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + scale_fill_gradient(low = "white", high = "black")
p = p + scale_colour_gradient(low = "white", high = "black")
p = p + theme(axis.line=element_blank(),axis.text.x=element_blank(),
axis.text.y=element_blank(),axis.ticks=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),legend.position="none",
panel.background=element_blank(),panel.border=element_blank(),panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),plot.background=element_blank())
p
ggsave("img/brain3.png",width=8,height=6)
p =ggplot(brain)
p = p +geom_tile(aes(x=x,y=y+1,fill=error),colour="black")
p = p +geom_text(aes(x=x,y=y+1,label="-"),subset(brain,layer=="lexical"),size=4,colour="black")
p = p +geom_tile(aes(x=xx-2.2,y=y-0.5,fill=act),colour="black")
p = p +geom_tile(aes(x=xx-1,y=y-2,fill=meaning),colour="black")
p = p + annotate(geom="segment",x=0,xend=0,y=0,yend=3.5,linetype="dotted",colour="gray50") # 0 axis
# scalp erps
erppos=3
p = p +geom_line(mapping=aes(x=x,y=sourceerp+erppos),data=eegwaves,colour="black")
p = p +geom_line(mapping=aes(x=x,y=sourceerp2+erppos),data=eegwaves,colour="black",linetype="dashed")
p = p + annotate("text",x = (lexlay+synlay)*0.55, y = 1, label = "Back-propagation\nof Error",size=3,hjust=0.5)
p = p + annotate("text",x = synlay-0.9, y = 1+2*nsize, label = "sum()",size=3,hjust=0.5, parse=T)
p=p + annotate(geom="segment",x=lexlay+nsize*2,xend=synlay-1,y=1+nsize,yend=1+2*nsize,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=lexlay+nsize*2,xend=synlay-1,y=1+2*nsize,yend=1+2*nsize,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=lexlay+nsize*2,xend=synlay-1,y=1+3*nsize,yend=1+2*nsize,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
#p=p + annotate(geom="segment",x=(lexlay+synlay)*0.25,xend=(lexlay+synlay)*0.75,y=1,yend=1,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=synlay-0.8,xend=synlay-nsize,y=1+2*nsize,yend=1+2*nsize,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = 0.1, y = 2.4, label = "0ms",size=3,hjust=0)
p = p + annotate("text",x = lexlay+0.3, y = 2.4, label = "400ms",size=3,hjust=0)
p = p + annotate("text",x = synlay+0.3, y = 2.4, label = "600ms",size=3,hjust=0)
p = p + annotate("text",x = lexlay+0.19, y = 0.9, label = "NextWord\nError")
p = p + annotate("text",x = synlay+0.19, y = 0.9, label = "Hidden\nError")
p = p + annotate("text",x = 1.4, y = -0.6, label = "PrevWord\nActivation")
p = p + annotate("text",x = 3.2, y = -0.6, label = "Hidden\nActivation")
p = p + annotate("text",x = 1.2, y = -1.3, label = "Forward Spread\nof Activation",size=3,hjust=0.5)
p = p + annotate("text",x = 2.6, y = -2.1, label = "CConcept\nActivation")
p=p + annotate(geom="segment",x=2.0,xend=2.5,y=-0.4,yend=-0.8,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = 4.5, y = -2.1, label = "MeaningComp\nActivation")
p=p + annotate(geom="segment",x=3.2,xend=3.9,y=-1.4,yend=-1.4,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=3.7,xend=4.4,y=-0.4,yend=-0.9,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
# legend
p = p + annotate("text",x = 1.5, y = erppos-0.6, label = "Violation",size=3,hjust=0)
p = p + annotate("text",x = 1.5, y = erppos-0.8, label = "Control",size=3,hjust=0)
p = p + annotate("segment",x = 1, xend=1.4, y = erppos-0.6, yend=erppos-0.6)
p = p + annotate("segment",x = 1, xend=1.4, y = erppos-0.8,yend = erppos-0.8, linetype="dashed")
# arrows to erps
p=p + annotate(geom="segment",x=lexlay+nsize/2,xend=lexlay+nsize/2,y=2.1,yend=erppos-0.4,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=synlay+nsize/2,xend=synlay+nsize/2,y=2.1,yend=erppos-0.4,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = lexlay-0.1, y = 2.3, label = "sum()",size=5,hjust=0.5, parse=T)
p = p + annotate("text",x = synlay-0.1, y = 2.3, label = "sum()",size=5,hjust=0.5, parse=T)
p = p + annotate("text",x = (lexlay+synlay)/2, y = 2.2, label = "Sum Abs. Error",size=3,hjust=0.5)
p = p + annotate("text",x = 0.3, y = 0.1, label = "\"was\"",size=4,hjust=0.5)
p=p + annotate(geom="segment",x=0.6,xend=0.9,y=0.1,yend=0.1,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = 2.1, y = 1.3, label = "Target\nSignal",size=3,hjust=0.5)
p=p + annotate(geom="segment",x=1.9,xend=3,y=0.8,yend=1.5,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=2,xend=2.7,y=0.1,yend=0.1,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = -0.1, y = 3.5, label = "+",size=5,hjust=0.5)
p = p + annotate("text",x = -0.1, y = 2.5, label = "-",size=5,hjust=0.5)
p = p + annotate("text",x = 5, y = -0.4, label = "Main Clause/Sentence Complement Ambiguity:\n\"The judge charged (that) the defendant     lying\"",hjust=0,size=3)
#p = p + annotate("text",x = 7, y = -0.5, label = "",hjust=0.5,size=3)
p = p + annotate("text", x = 7.665, y = -0.49, label = "was",
size=3, fontface =2)
p = p + annotate("text",x = 6.4, y = 3.5, label = "ERPs",hjust=0.5,size=3)
p = p + annotate("text",x = 4.3, y = 0.1, label = "Eye-movements",hjust=0.5,size=3)
p = p + annotate("text",x = 6, y = -1.5, label = "Judgements/\nQuestion Answering",hjust=0.5,size=3)
p = p + annotate(geom="curve",x=5,xend=5,y=-1.6,yend=-1.2,curvature=1.5,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + scale_fill_gradient(low = "white", high = "black")
p = p + scale_colour_gradient(low = "white", high = "black")
p = p + theme(axis.line=element_blank(),axis.text.x=element_blank(),
axis.text.y=element_blank(),axis.ticks=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),legend.position="none",
panel.background=element_blank(),panel.border=element_blank(),panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),plot.background=element_blank())
p
ggsave("img/brain3.png",width=8,height=6)
p =ggplot(brain)
p = p +geom_tile(aes(x=x,y=y+1,fill=error),colour="black")
p = p +geom_text(aes(x=x,y=y+1,label="-"),subset(brain,layer=="lexical"),size=4,colour="black")
p = p +geom_tile(aes(x=xx-2.2,y=y-0.5,fill=act),colour="black")
p = p +geom_tile(aes(x=xx-1,y=y-2,fill=meaning),colour="black")
p = p + annotate(geom="segment",x=0,xend=0,y=0,yend=3.5,linetype="dotted",colour="gray50") # 0 axis
# scalp erps
erppos=3
p = p +geom_line(mapping=aes(x=x,y=sourceerp+erppos),data=eegwaves,colour="black")
p = p +geom_line(mapping=aes(x=x,y=sourceerp2+erppos),data=eegwaves,colour="black",linetype="dashed")
p = p + annotate("text",x = (lexlay+synlay)*0.55, y = 1, label = "Back-propagation\nof Error",size=3,hjust=0.5)
p = p + annotate("text",x = synlay-0.9, y = 1+2*nsize, label = "sum()",size=3,hjust=0.5, parse=T)
p=p + annotate(geom="segment",x=lexlay+nsize*2,xend=synlay-1,y=1+nsize,yend=1+2*nsize,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=lexlay+nsize*2,xend=synlay-1,y=1+2*nsize,yend=1+2*nsize,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=lexlay+nsize*2,xend=synlay-1,y=1+3*nsize,yend=1+2*nsize,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
#p=p + annotate(geom="segment",x=(lexlay+synlay)*0.25,xend=(lexlay+synlay)*0.75,y=1,yend=1,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=synlay-0.8,xend=synlay-nsize,y=1+2*nsize,yend=1+2*nsize,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = 0.1, y = 2.4, label = "0ms",size=3,hjust=0)
p = p + annotate("text",x = lexlay+0.3, y = 2.4, label = "400ms",size=3,hjust=0)
p = p + annotate("text",x = synlay+0.3, y = 2.4, label = "600ms",size=3,hjust=0)
p = p + annotate("text",x = lexlay+0.19, y = 0.9, label = "NextWord\nError")
p = p + annotate("text",x = synlay+0.19, y = 0.9, label = "Hidden\nError")
p = p + annotate("text",x = 1.4, y = -0.6, label = "PrevWord\nActivation")
p = p + annotate("text",x = 3.2, y = -0.6, label = "Hidden\nActivation")
p = p + annotate("text",x = 1.2, y = -1.3, label = "Forward Spread\nof Activation",size=3,hjust=0.5)
p = p + annotate("text",x = 2.6, y = -2.1, label = "CConcept\nActivation")
p=p + annotate(geom="segment",x=2.0,xend=2.5,y=-0.4,yend=-0.8,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = 4.5, y = -2.1, label = "MeaningComp\nActivation")
p=p + annotate(geom="segment",x=3.2,xend=3.9,y=-1.4,yend=-1.4,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=3.7,xend=4.4,y=-0.4,yend=-0.9,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
# legend
p = p + annotate("text",x = 1.5, y = erppos-0.6, label = "Violation",size=3,hjust=0)
p = p + annotate("text",x = 1.5, y = erppos-0.8, label = "Control",size=3,hjust=0)
p = p + annotate("segment",x = 1, xend=1.4, y = erppos-0.6, yend=erppos-0.6)
p = p + annotate("segment",x = 1, xend=1.4, y = erppos-0.8,yend = erppos-0.8, linetype="dashed")
# arrows to erps
p=p + annotate(geom="segment",x=lexlay+nsize/2,xend=lexlay+nsize/2,y=2.1,yend=erppos-0.4,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=synlay+nsize/2,xend=synlay+nsize/2,y=2.1,yend=erppos-0.4,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = lexlay-0.1, y = 2.3, label = "sum()",size=5,hjust=0.5, parse=T)
p = p + annotate("text",x = synlay-0.1, y = 2.3, label = "sum()",size=5,hjust=0.5, parse=T)
p = p + annotate("text",x = (lexlay+synlay)/2, y = 2.2, label = "Sum Abs. Error",size=3,hjust=0.5)
p = p + annotate("text",x = 0.3, y = 0.1, label = "\"was\"",size=4,hjust=0.5)
p=p + annotate(geom="segment",x=0.6,xend=0.9,y=0.1,yend=0.1,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = 2.1, y = 1.3, label = "Target\nSignal",size=3,hjust=0.5)
p=p + annotate(geom="segment",x=1.9,xend=3,y=0.8,yend=1.5,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=2,xend=2.7,y=0.1,yend=0.1,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = -0.1, y = 3.5, label = "+",size=5,hjust=0.5)
p = p + annotate("text",x = -0.1, y = 2.5, label = "-",size=5,hjust=0.5)
p = p + annotate("text",x = 5, y = -0.4, label = "Main Clause/Sentence Complement Ambiguity:\n\"The judge charged (that) the defendant was lying\"",hjust=0,size=3)
#p = p + annotate("text",x = 7, y = -0.5, label = "",hjust=0.5,size=3)
p = p + annotate("text", x = 7.665, y = -0.5, label = "was",
size=3, fontface =2)
p = p + annotate("text",x = 6.4, y = 3.5, label = "ERPs",hjust=0.5,size=3)
p = p + annotate("text",x = 4.3, y = 0.1, label = "Eye-movements",hjust=0.5,size=3)
p = p + annotate("text",x = 6, y = -1.5, label = "Judgements/\nQuestion Answering",hjust=0.5,size=3)
p = p + annotate(geom="curve",x=5,xend=5,y=-1.6,yend=-1.2,curvature=1.5,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + scale_fill_gradient(low = "white", high = "black")
p = p + scale_colour_gradient(low = "white", high = "black")
p = p + theme(axis.line=element_blank(),axis.text.x=element_blank(),
axis.text.y=element_blank(),axis.ticks=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),legend.position="none",
panel.background=element_blank(),panel.border=element_blank(),panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),plot.background=element_blank())
p
ggsave("img/brain3.png",width=8,height=6)
p =ggplot(brain)
p = p +geom_tile(aes(x=x,y=y+1,fill=error),colour="black")
p = p +geom_text(aes(x=x,y=y+1,label="-"),subset(brain,layer=="lexical"),size=4,colour="black")
p = p +geom_tile(aes(x=xx-2.2,y=y-0.5,fill=act),colour="black")
p = p +geom_tile(aes(x=xx-1,y=y-2,fill=meaning),colour="black")
p = p + annotate(geom="segment",x=0,xend=0,y=0,yend=3.5,linetype="dotted",colour="gray50") # 0 axis
# scalp erps
erppos=3
p = p +geom_line(mapping=aes(x=x,y=sourceerp+erppos),data=eegwaves,colour="black")
p = p +geom_line(mapping=aes(x=x,y=sourceerp2+erppos),data=eegwaves,colour="black",linetype="dashed")
p = p + annotate("text",x = (lexlay+synlay)*0.55, y = 1, label = "Back-propagation\nof Error",size=3,hjust=0.5)
p = p + annotate("text",x = synlay-0.9, y = 1+2*nsize, label = "sum()",size=3,hjust=0.5, parse=T)
p=p + annotate(geom="segment",x=lexlay+nsize*2,xend=synlay-1,y=1+nsize,yend=1+2*nsize,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=lexlay+nsize*2,xend=synlay-1,y=1+2*nsize,yend=1+2*nsize,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=lexlay+nsize*2,xend=synlay-1,y=1+3*nsize,yend=1+2*nsize,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
#p=p + annotate(geom="segment",x=(lexlay+synlay)*0.25,xend=(lexlay+synlay)*0.75,y=1,yend=1,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=synlay-0.8,xend=synlay-nsize,y=1+2*nsize,yend=1+2*nsize,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = 0.1, y = 2.4, label = "0ms",size=3,hjust=0)
p = p + annotate("text",x = lexlay+0.3, y = 2.4, label = "400ms",size=3,hjust=0)
p = p + annotate("text",x = synlay+0.3, y = 2.4, label = "600ms",size=3,hjust=0)
p = p + annotate("text",x = lexlay+0.19, y = 0.9, label = "NextWord\nError")
p = p + annotate("text",x = synlay+0.19, y = 0.9, label = "Hidden\nError")
p = p + annotate("text",x = 1.4, y = -0.6, label = "PrevWord\nActivation")
p = p + annotate("text",x = 3.2, y = -0.6, label = "Hidden\nActivation")
p = p + annotate("text",x = 1.2, y = -1.3, label = "Forward Spread\nof Activation",size=3,hjust=0.5)
p = p + annotate("text",x = 2.6, y = -2.1, label = "CConcept\nActivation")
p=p + annotate(geom="segment",x=2.0,xend=2.5,y=-0.4,yend=-0.8,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = 4.5, y = -2.1, label = "MeaningComp\nActivation")
p=p + annotate(geom="segment",x=3.2,xend=3.9,y=-1.4,yend=-1.4,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=3.7,xend=4.4,y=-0.4,yend=-0.9,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
# legend
p = p + annotate("text",x = 1.5, y = erppos-0.6, label = "Violation",size=3,hjust=0)
p = p + annotate("text",x = 1.5, y = erppos-0.8, label = "Control",size=3,hjust=0)
p = p + annotate("segment",x = 1, xend=1.4, y = erppos-0.6, yend=erppos-0.6)
p = p + annotate("segment",x = 1, xend=1.4, y = erppos-0.8,yend = erppos-0.8, linetype="dashed")
# arrows to erps
p=p + annotate(geom="segment",x=lexlay+nsize/2,xend=lexlay+nsize/2,y=2.1,yend=erppos-0.4,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=synlay+nsize/2,xend=synlay+nsize/2,y=2.1,yend=erppos-0.4,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = lexlay-0.1, y = 2.3, label = "sum()",size=5,hjust=0.5, parse=T)
p = p + annotate("text",x = synlay-0.1, y = 2.3, label = "sum()",size=5,hjust=0.5, parse=T)
p = p + annotate("text",x = (lexlay+synlay)/2, y = 2.2, label = "Sum Abs. Error",size=3,hjust=0.5)
p = p + annotate("text",x = 0.3, y = 0.1, label = "\"was\"",size=4,hjust=0.5)
p=p + annotate(geom="segment",x=0.6,xend=0.9,y=0.1,yend=0.1,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = 2.1, y = 1.3, label = "Target\nSignal",size=3,hjust=0.5)
p=p + annotate(geom="segment",x=1.9,xend=3,y=0.8,yend=1.5,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p=p + annotate(geom="segment",x=2,xend=2.7,y=0.1,yend=0.1,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + annotate("text",x = -0.1, y = 3.5, label = "+",size=5,hjust=0.5)
p = p + annotate("text",x = -0.1, y = 2.5, label = "-",size=5,hjust=0.5)
p = p + annotate("text",x = 5, y = -0.4, label = "Main Clause/Sentence Complement Ambiguity:\n\"The judge charged (that) the defendant was lying\"",hjust=0,size=3)
#p = p + annotate("text",x = 7, y = -0.5, label = "",hjust=0.5,size=3)
p = p + annotate("text", x = 7.67, y = -0.495, label = "was",
size=3, fontface =2)
p = p + annotate("text",x = 6.4, y = 3.5, label = "ERPs",hjust=0.5,size=3)
p = p + annotate("text",x = 4.3, y = 0.1, label = "Eye-movements",hjust=0.5,size=3)
p = p + annotate("text",x = 6, y = -1.5, label = "Judgements/\nQuestion Answering",hjust=0.5,size=3)
p = p + annotate(geom="curve",x=5,xend=5,y=-1.6,yend=-1.2,curvature=1.5,colour="gray50",arrow = arrow(length = unit(0.3, "cm")))
p = p + scale_fill_gradient(low = "white", high = "black")
p = p + scale_colour_gradient(low = "white", high = "black")
p = p + theme(axis.line=element_blank(),axis.text.x=element_blank(),
axis.text.y=element_blank(),axis.ticks=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),legend.position="none",
panel.background=element_blank(),panel.border=element_blank(),panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),plot.background=element_blank())
p
ggsave("img/brain3.png",width=8,height=6)
